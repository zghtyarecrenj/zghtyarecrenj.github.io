<!DOCTYPE html>
<html lang="zn-Hans">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1" />
  <meta name="author" content="zghtyarecrenj">
  <meta name="description" content="… JOISC2020 Day4 T1 Capital City 题意 有 \(n\) 个小镇形成一棵树，第 \(i\) 个小镇属于城市 \(C_i\)。要从城市里面选出一个首都，使得从首都中的任一个城镇到达另一个首都中的城镇可以只经过首都中的城镇。现在可能不存在这样的城市，所以求最少合并几个城市才能选出一个首都。 题解 考虑建图。若第 \(i\) 个城市的小镇之间的路径经过第 \(j\) 个城市的小镇，则我们连一条边 \((i,j)\)。 在这张图中求出强连通分量，不难发现出度为 \(0\) 的强连通分量的节点数最小值">
  
  <meta property="og:title" content="Joisc2020d4t1" />
<meta property="og:description" content="… JOISC2020 Day4 T1 Capital City 题意 有 \(n\) 个小镇形成一棵树，第 \(i\) 个小镇属于城市 \(C_i\)。要从城市里面选出一个首都，使得从首都中的任一个城镇到达另一个首都中的城镇可以只经过首都中的城镇。现在可能不存在这样的城市，所以求最少合并几个城市才能选出一个首都。 题解 考虑建图。若第 \(i\) 个城市的小镇之间的路径经过第 \(j\) 个城市的小镇，则我们连一条边 \((i,j)\)。 在这张图中求出强连通分量，不难发现出度为 \(0\) 的强连通分量的节点数最小值" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zghtyarecrenj.github.io/post/joisc2020d4t1/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-06-05T11:07:28&#43;08:00" />
<meta property="article:modified_time" content="2021-06-05T11:07:28&#43;08:00" />



  <title>
  
       Joisc2020d4t1 | zghtyarecrenj&#39;s blog 
  
  </title>

  <link rel="canonical" href="https://zghtyarecrenj.github.io/post/joisc2020d4t1/">

  
  

  
  <link href="https://zghtyarecrenj.github.io/css/vendors-extensions/fontawesome/all.min.css" rel="stylesheet">

  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:300,400,500,600">
  <link href="https://zghtyarecrenj.github.io/css/font.css" rel="stylesheet"> 
    
  
  <link href="https://zghtyarecrenj.github.io/css/vendors/bootstrap4/bootstrap.min.css" rel="stylesheet">
  <link href="https://zghtyarecrenj.github.io/css/vendors-extensions/mdb/mdb.min.css" rel="stylesheet"> 
  <link href="https://zghtyarecrenj.github.io/css/vendors/mdb/style.min.css" rel="stylesheet"> 
  <link href="https://zghtyarecrenj.github.io/css/main.css" rel="stylesheet">


  
  <link rel="shortcut icon"
  
      href="https://zghtyarecrenj.github.io/img/fav.jpg"
  
  >


  
  

  <style type="text/css">
      @media (min-width: 800px) and (max-width: 850px) {
              .navbar:not(.top-nav-collapse) {
                  background: #1C2331!important;
              }
          }
  </style>


  
  
  

  
    
    <link rel="stylesheet" href="https://zghtyarecrenj.github.io/css/vendors/highlight/github-gist.css">
  

</head>

  <body class="bg-light" data-spy="scroll" data-target="#page-scrollspy" data-offset="90">
  
    
    

    
      


<nav class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar">
    <div class="container">

      
      <a class="navbar-brand" href="https://zghtyarecrenj.github.io">
          
        <img class="avatar" src="https://zghtyarecrenj.github.io/img/fav.jpg" style="width: 40px!important;height: auto;"  class="d-inline-block align-top" alt="" >
        
        <strong> zghtyarecrenj</strong>
      </a>

      
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      
      <div class="collapse navbar-collapse" id="navbarSupportedContent">

        
        <ul class="navbar-nav mr-auto ">
          <li class="nav-item ">
            <a class="nav-link" href="https://zghtyarecrenj.github.io">Home</a>
          </li>
             
            <li class="nav-item ">
              <a class="nav-link" href="https://zghtyarecrenj.github.io/blog/" >Blog  </a>
            </li>
          
             
            <li class="nav-item ">
              <a class="nav-link" href="https://zghtyarecrenj.github.io/moment/" >Moment  </a>
            </li>
          
             
            <li class="nav-item ">
              <a class="nav-link" href="https://zghtyarecrenj.github.io/about/" >About  </a>
            </li>
          
          
        </ul>

      </div>

    </div>
  </nav>
  
 
      
 






<div id="site-header" class="carousel slide carousel-fade" data-ride="carousel" style="height: 18rem;" >  

  
  
  

  
  <div class="carousel-inner" role="listbox">
    
      

        
        <div class="carousel-item active">
          <div class="view" style="background-image: url('https://zghtyarecrenj.github.io/img/header-slides/1346329fa6990e8c88838a1799587177.jpeg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

              
              
              

            </div>
            

          </div>
        </div>
        
      
    
      

        
        <div class="carousel-item">
          <div class="view" style="background-image: url('https://zghtyarecrenj.github.io/img/header-slides//4cfcb480528e250e0064847085e7052a.jpeg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

            

            </div>
            

          </div>
        </div>
        
      
    
      

        
        <div class="carousel-item">
          <div class="view" style="background-image: url('https://zghtyarecrenj.github.io/img/header-slides//68d00805177931258a1129efd6753df5.jpeg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

            

            </div>
            

          </div>
        </div>
        
      
    

  
  </div>
  

  
  <div class="carousel-content text-center white-text wow fadeIn">
    <div class="row mx-0 headfont mt-3 pt-4">
      
      <div class="col-12 col-sm-5 align-middle">
        <a href="https://zghtyarecrenj.github.io">
          
            <img class="pull-right avatar avatar-md" src="https://zghtyarecrenj.github.io/img/fav.jpg" alt="" >
          
        </a>
      </div>
      
      <div class="col-12 col-sm-7 text-left pl-2">
        <a href="https://zghtyarecrenj.github.io">
          <h1 class="mb-2 h1" style="font-weight: 300;" >
            <strong>zghtyarecrenj&#39;s blog</strong>
          </h1>
        </a>
        

             
        <div class="mt-2" style="font-size: 1rem; color: white;">
            
              <a href="//github.com/zghtyarecrenj" target="_blank" rel="noopener"><i class="fab fa-github pr-1" aria-hidden="true"></i></a>    
            
            

            

            

            

            
    
            
    
        
            
                <a href="mailto:zghtyarecrenj@qq.com"><i class="far fa-envelope-open pr-1" aria-hidden="true"></i></a>
            
    
            

            
        </div>
      </div>
    </div>
  </div>
  

  
  
  

</div>
  
    

    
  
  <main class="post-main-wrapper">
    
    
    <div class="row">

      

      
      <div class="container pr-5">
      

        
        <div class="z-depth-1  post-wrapper white-bg single-post">

          <div class="post-header text-center" >
  <ul class="post-meta li-x">
    
    
  </ul>

  <div class="px-4 post-heading">Joisc2020d4t1</div>

  <ul class="post-meta li-x mt-1">
    
      <li>Jun 5, 2021</li>
    

    
      <li class="middot"></li>
      <li>2 minutes read</li>
    
  </ul>
  

</div>


          <div class="post-content markdown">
            <html>
<head>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js" integrity="sha384-YNHdsYkH6gMx9y3mRkmcJ2mFUjTd0qNQQvY9VYZgQd7DcN7env35GzlmFaZ23JGp" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
</head>
…
</html>
<h2 id="joisc2020-day4-t1-capital-city">JOISC2020 Day4 T1 Capital City</h2>
<h3 id="题意">题意</h3>
<p>有 <span class="math inline">\(n\)</span> 个小镇形成一棵树，第 <span class="math inline">\(i\)</span> 个小镇属于城市 <span class="math inline">\(C_i\)</span>。要从城市里面选出一个首都，使得从首都中的任一个城镇到达另一个首都中的城镇可以只经过首都中的城镇。现在可能不存在这样的城市，所以求最少合并几个城市才能选出一个首都。</p>
<h3 id="题解">题解</h3>
<p>考虑建图。若第 <span class="math inline">\(i\)</span> 个城市的小镇之间的路径经过第 <span class="math inline">\(j\)</span> 个城市的小镇，则我们连一条边 <span class="math inline">\((i,j)\)</span>。</p>
<p>在这张图中求出强连通分量，不难发现出度为 <span class="math inline">\(0\)</span> 的强连通分量的节点数最小值就是答案。</p>
<p>线段树优化建图+树剖+缩点不难解决。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="pp">#include </span><span class="im">&lt;bits/stdc++.h&gt;</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">namespace</span> zghtyarecrenj</a>
<a class="sourceLine" id="cb1-4" title="4">{</a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="pp">#define gc</span>()<span class="pp"> </span>getchar()</a>
<a class="sourceLine" id="cb1-6" title="6">    <span class="kw">template</span> &lt;<span class="kw">typename</span> Ty&gt;</a>
<a class="sourceLine" id="cb1-7" title="7">    <span class="kw">inline</span> <span class="dt">void</span> read(Ty &amp;t)</a>
<a class="sourceLine" id="cb1-8" title="8">    {</a>
<a class="sourceLine" id="cb1-9" title="9">        t = <span class="dv">0</span>; <span class="dt">bool</span> neg = <span class="dv">0</span>; <span class="dt">char</span> ch = gc();</a>
<a class="sourceLine" id="cb1-10" title="10">        <span class="cf">while</span> (ch != <span class="ch">&#39;-&#39;</span> &amp;&amp; (ch &lt; <span class="ch">&#39;0&#39;</span> || ch &gt; <span class="ch">&#39;9&#39;</span>)) ch = gc();</a>
<a class="sourceLine" id="cb1-11" title="11">        <span class="cf">if</span> (ch == <span class="ch">&#39;-&#39;</span>) neg = <span class="dv">1</span>;</a>
<a class="sourceLine" id="cb1-12" title="12">        <span class="cf">do</span> { t = t * <span class="dv">10</span> + ch - <span class="ch">&#39;0&#39;</span>; ch = gc(); } <span class="cf">while</span> (ch &gt;= <span class="ch">&#39;0&#39;</span> &amp;&amp; ch &lt;= <span class="ch">&#39;9&#39;</span>);</a>
<a class="sourceLine" id="cb1-13" title="13">        <span class="cf">if</span> (neg) t = -t;</a>
<a class="sourceLine" id="cb1-14" title="14">    }</a>
<a class="sourceLine" id="cb1-15" title="15">} <span class="co">// namespace zghtyarecrenj</span></a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="kw">using</span> zghtyarecrenj::read;</a>
<a class="sourceLine" id="cb1-18" title="18"></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="at">const</span> <span class="dt">int</span> N = <span class="fl">2e5</span> + <span class="dv">5</span>;</a>
<a class="sourceLine" id="cb1-20" title="20"><span class="at">const</span> <span class="dt">int</span> V = <span class="fl">1e6</span> + <span class="dv">5</span>;</a>
<a class="sourceLine" id="cb1-21" title="21"></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="dt">int</span> k, n, c[N], pool, rt;</a>
<a class="sourceLine" id="cb1-23" title="23"><span class="bu">std::</span>vector&lt;<span class="dt">int</span>&gt; g[N], G[V], a[N];</a>
<a class="sourceLine" id="cb1-24" title="24"><span class="dt">int</span> dep[N], anc[N], siz[N], son[N], seg[N], rev[N], top[N], scnt;</a>
<a class="sourceLine" id="cb1-25" title="25"><span class="dt">int</span> dfn[V], low[V], vis[V], res[V], cnt, sz[V], du[V], tot;</a>
<a class="sourceLine" id="cb1-26" title="26"><span class="bu">std::</span>stack&lt;<span class="dt">int</span>&gt; s;</a>
<a class="sourceLine" id="cb1-27" title="27"></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="kw">struct</span> Node</a>
<a class="sourceLine" id="cb1-29" title="29">{</a>
<a class="sourceLine" id="cb1-30" title="30">    <span class="dt">int</span> L, R, ls, rs;</a>
<a class="sourceLine" id="cb1-31" title="31">} T[N &lt;&lt; <span class="dv">2</span>];</a>
<a class="sourceLine" id="cb1-32" title="32"></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="dt">int</span> build(<span class="dt">int</span> l, <span class="dt">int</span> r)</a>
<a class="sourceLine" id="cb1-34" title="34">{</a>
<a class="sourceLine" id="cb1-35" title="35">    <span class="dt">int</span> k = ++pool;</a>
<a class="sourceLine" id="cb1-36" title="36">    T[k].L = l, T[k].R = r;</a>
<a class="sourceLine" id="cb1-37" title="37">    <span class="cf">if</span> (l == r)</a>
<a class="sourceLine" id="cb1-38" title="38">    {</a>
<a class="sourceLine" id="cb1-39" title="39">        G[k].push_back(c[rev[l]]);</a>
<a class="sourceLine" id="cb1-40" title="40">        <span class="cf">return</span> k;</a>
<a class="sourceLine" id="cb1-41" title="41">    }</a>
<a class="sourceLine" id="cb1-42" title="42">    <span class="dt">int</span> mid = (l + r) / <span class="dv">2</span>;</a>
<a class="sourceLine" id="cb1-43" title="43">    T[k].ls = build(l, mid);</a>
<a class="sourceLine" id="cb1-44" title="44">    T[k].rs = build(mid + <span class="dv">1</span>, r);</a>
<a class="sourceLine" id="cb1-45" title="45">    G[k].push_back(T[k].ls);</a>
<a class="sourceLine" id="cb1-46" title="46">    G[k].push_back(T[k].rs);</a>
<a class="sourceLine" id="cb1-47" title="47">    <span class="cf">return</span> k;</a>
<a class="sourceLine" id="cb1-48" title="48">}</a>
<a class="sourceLine" id="cb1-49" title="49"></a>
<a class="sourceLine" id="cb1-50" title="50"><span class="dt">void</span> add(<span class="dt">int</span> k, <span class="dt">int</span> x, <span class="dt">int</span> y, <span class="dt">int</span> d)</a>
<a class="sourceLine" id="cb1-51" title="51">{</a>
<a class="sourceLine" id="cb1-52" title="52">    <span class="cf">if</span> (x &lt;= T[k].L &amp;&amp; T[k].R &lt;= y)</a>
<a class="sourceLine" id="cb1-53" title="53">    {</a>
<a class="sourceLine" id="cb1-54" title="54">        G[d].push_back(k);</a>
<a class="sourceLine" id="cb1-55" title="55">        <span class="cf">return</span>;</a>
<a class="sourceLine" id="cb1-56" title="56">    }</a>
<a class="sourceLine" id="cb1-57" title="57">    <span class="dt">int</span> mid = (T[k].L + T[k].R) / <span class="dv">2</span>;</a>
<a class="sourceLine" id="cb1-58" title="58">    <span class="cf">if</span> (x &lt;= mid)</a>
<a class="sourceLine" id="cb1-59" title="59">        add(T[k].ls, x, y, d);</a>
<a class="sourceLine" id="cb1-60" title="60">    <span class="cf">if</span> (y &gt; mid)</a>
<a class="sourceLine" id="cb1-61" title="61">        add(T[k].rs, x, y, d);</a>
<a class="sourceLine" id="cb1-62" title="62">}</a>
<a class="sourceLine" id="cb1-63" title="63"></a>
<a class="sourceLine" id="cb1-64" title="64"><span class="dt">void</span> dfs1(<span class="dt">int</span> u, <span class="dt">int</span> fa)</a>
<a class="sourceLine" id="cb1-65" title="65">{</a>
<a class="sourceLine" id="cb1-66" title="66">    dep[u] = dep[fa] + <span class="dv">1</span>, anc[u] = fa, siz[u] = <span class="dv">1</span>;</a>
<a class="sourceLine" id="cb1-67" title="67">    <span class="cf">for</span> (<span class="dt">int</span> v : g[u])</a>
<a class="sourceLine" id="cb1-68" title="68">        <span class="cf">if</span> (v != fa)</a>
<a class="sourceLine" id="cb1-69" title="69">        {</a>
<a class="sourceLine" id="cb1-70" title="70">            dfs1(v, u);</a>
<a class="sourceLine" id="cb1-71" title="71">            siz[u] += siz[v];</a>
<a class="sourceLine" id="cb1-72" title="72">            <span class="cf">if</span> (siz[v] &gt; siz[son[u]])</a>
<a class="sourceLine" id="cb1-73" title="73">                son[u] = v;</a>
<a class="sourceLine" id="cb1-74" title="74">        }</a>
<a class="sourceLine" id="cb1-75" title="75">}</a>
<a class="sourceLine" id="cb1-76" title="76"></a>
<a class="sourceLine" id="cb1-77" title="77"><span class="dt">void</span> dfs2(<span class="dt">int</span> u, <span class="dt">int</span> tp)</a>
<a class="sourceLine" id="cb1-78" title="78">{</a>
<a class="sourceLine" id="cb1-79" title="79">    top[u] = tp, seg[u] = ++scnt, rev[scnt] = u;</a>
<a class="sourceLine" id="cb1-80" title="80">    <span class="cf">if</span> (son[u]) dfs2(son[u], tp);</a>
<a class="sourceLine" id="cb1-81" title="81">    <span class="cf">for</span> (<span class="dt">int</span> v : g[u])</a>
<a class="sourceLine" id="cb1-82" title="82">        <span class="cf">if</span> (v != anc[u] &amp;&amp; v != son[u])</a>
<a class="sourceLine" id="cb1-83" title="83">            dfs2(v, v);</a>
<a class="sourceLine" id="cb1-84" title="84">}</a>
<a class="sourceLine" id="cb1-85" title="85"></a>
<a class="sourceLine" id="cb1-86" title="86"><span class="kw">inline</span> <span class="dt">int</span> lca(<span class="dt">int</span> u, <span class="dt">int</span> v)</a>
<a class="sourceLine" id="cb1-87" title="87">{</a>
<a class="sourceLine" id="cb1-88" title="88">    <span class="cf">while</span> (top[u] != top[v])</a>
<a class="sourceLine" id="cb1-89" title="89">    {</a>
<a class="sourceLine" id="cb1-90" title="90">        <span class="cf">if</span> (dep[top[u]] &lt; dep[top[v]]) </a>
<a class="sourceLine" id="cb1-91" title="91">            <span class="bu">std::</span>swap(u, v);</a>
<a class="sourceLine" id="cb1-92" title="92">        u = anc[top[u]];</a>
<a class="sourceLine" id="cb1-93" title="93">    }</a>
<a class="sourceLine" id="cb1-94" title="94">    <span class="cf">return</span> dep[u] &lt; dep[v] ? u : v;</a>
<a class="sourceLine" id="cb1-95" title="95">}</a>
<a class="sourceLine" id="cb1-96" title="96"></a>
<a class="sourceLine" id="cb1-97" title="97"><span class="dt">void</span> modify(<span class="dt">int</span> u, <span class="dt">int</span> v)</a>
<a class="sourceLine" id="cb1-98" title="98">{</a>
<a class="sourceLine" id="cb1-99" title="99">    <span class="dt">int</span> cx = c[u];</a>
<a class="sourceLine" id="cb1-100" title="100">    <span class="cf">while</span> (top[u] != top[v])</a>
<a class="sourceLine" id="cb1-101" title="101">    {</a>
<a class="sourceLine" id="cb1-102" title="102">        <span class="cf">if</span> (dep[top[u]] &lt; dep[top[v]])</a>
<a class="sourceLine" id="cb1-103" title="103">            <span class="bu">std::</span>swap(u, v);</a>
<a class="sourceLine" id="cb1-104" title="104">        add(rt, seg[top[u]], seg[u], cx);</a>
<a class="sourceLine" id="cb1-105" title="105">        u = anc[top[u]];</a>
<a class="sourceLine" id="cb1-106" title="106">    }</a>
<a class="sourceLine" id="cb1-107" title="107">    <span class="cf">if</span> (dep[v] &gt; dep[u])</a>
<a class="sourceLine" id="cb1-108" title="108">        <span class="bu">std::</span>swap(u, v);</a>
<a class="sourceLine" id="cb1-109" title="109">    add(rt, seg[v], seg[u], cx);</a>
<a class="sourceLine" id="cb1-110" title="110">}</a>
<a class="sourceLine" id="cb1-111" title="111"></a>
<a class="sourceLine" id="cb1-112" title="112"><span class="dt">void</span> tarjan(<span class="dt">int</span> u)</a>
<a class="sourceLine" id="cb1-113" title="113">{</a>
<a class="sourceLine" id="cb1-114" title="114">    dfn[u] = low[u] = ++tot, vis[u] = <span class="dv">1</span>, s.push(u);</a>
<a class="sourceLine" id="cb1-115" title="115">    <span class="cf">for</span> (<span class="dt">int</span> v : G[u])</a>
<a class="sourceLine" id="cb1-116" title="116">    {</a>
<a class="sourceLine" id="cb1-117" title="117">        <span class="cf">if</span> (dfn[v] == -<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-118" title="118">        {</a>
<a class="sourceLine" id="cb1-119" title="119">            tarjan(v);</a>
<a class="sourceLine" id="cb1-120" title="120">            low[u] = <span class="bu">std::</span>min(low[u], low[v]);</a>
<a class="sourceLine" id="cb1-121" title="121">        }</a>
<a class="sourceLine" id="cb1-122" title="122">        <span class="cf">else</span> <span class="cf">if</span> (vis[v])</a>
<a class="sourceLine" id="cb1-123" title="123">            low[u] = <span class="bu">std::</span>min(low[u], dfn[v]);</a>
<a class="sourceLine" id="cb1-124" title="124">    }</a>
<a class="sourceLine" id="cb1-125" title="125">    <span class="cf">if</span> (dfn[u] == low[u])</a>
<a class="sourceLine" id="cb1-126" title="126">    {</a>
<a class="sourceLine" id="cb1-127" title="127">        ++cnt;</a>
<a class="sourceLine" id="cb1-128" title="128">        <span class="cf">while</span> (<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-129" title="129">        {</a>
<a class="sourceLine" id="cb1-130" title="130">            <span class="dt">int</span> cur = s.top(); s.pop();</a>
<a class="sourceLine" id="cb1-131" title="131">            vis[cur] = <span class="dv">0</span>, res[cur] = cnt;</a>
<a class="sourceLine" id="cb1-132" title="132">            <span class="cf">if</span> (u == cur) <span class="cf">break</span>;</a>
<a class="sourceLine" id="cb1-133" title="133">        }</a>
<a class="sourceLine" id="cb1-134" title="134">    }</a>
<a class="sourceLine" id="cb1-135" title="135">}</a>
<a class="sourceLine" id="cb1-136" title="136"></a>
<a class="sourceLine" id="cb1-137" title="137"><span class="dt">int</span> main()</a>
<a class="sourceLine" id="cb1-138" title="138">{</a>
<a class="sourceLine" id="cb1-139" title="139">    read(n), read(k);</a>
<a class="sourceLine" id="cb1-140" title="140">    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt; n; ++i)</a>
<a class="sourceLine" id="cb1-141" title="141">    {</a>
<a class="sourceLine" id="cb1-142" title="142">        <span class="dt">int</span> x, y;</a>
<a class="sourceLine" id="cb1-143" title="143">        read(x), read(y);</a>
<a class="sourceLine" id="cb1-144" title="144">        g[x].push_back(y), g[y].push_back(x);</a>
<a class="sourceLine" id="cb1-145" title="145">    }</a>
<a class="sourceLine" id="cb1-146" title="146">    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= n; ++i)</a>
<a class="sourceLine" id="cb1-147" title="147">        read(c[i]), a[c[i]].push_back(i);</a>
<a class="sourceLine" id="cb1-148" title="148">    pool = k;</a>
<a class="sourceLine" id="cb1-149" title="149">    dfs1(<span class="dv">1</span>, <span class="dv">0</span>);</a>
<a class="sourceLine" id="cb1-150" title="150">    dfs2(<span class="dv">1</span>, <span class="dv">1</span>);</a>
<a class="sourceLine" id="cb1-151" title="151">    rt = build(<span class="dv">1</span>, n);</a>
<a class="sourceLine" id="cb1-152" title="152">    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= k; ++i)</a>
<a class="sourceLine" id="cb1-153" title="153">        <span class="cf">if</span> (a[i].size() &gt; <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-154" title="154">        {</a>
<a class="sourceLine" id="cb1-155" title="155">            <span class="dt">int</span> m = a[i][<span class="dv">0</span>];</a>
<a class="sourceLine" id="cb1-156" title="156">            <span class="cf">for</span> (<span class="dt">int</span> j = <span class="dv">1</span>; j &lt; a[i].size(); ++j)</a>
<a class="sourceLine" id="cb1-157" title="157">            {</a>
<a class="sourceLine" id="cb1-158" title="158">                    <span class="dt">int</span> l = lca(a[i][<span class="dv">0</span>], a[i][j]);</a>
<a class="sourceLine" id="cb1-159" title="159">                    <span class="cf">if</span> (a[i][j] != l) </a>
<a class="sourceLine" id="cb1-160" title="160">                        modify(a[i][j], l);</a>
<a class="sourceLine" id="cb1-161" title="161">                    <span class="cf">if</span> (dep[l] &lt; dep[m])</a>
<a class="sourceLine" id="cb1-162" title="162">                        m = l;</a>
<a class="sourceLine" id="cb1-163" title="163">            }</a>
<a class="sourceLine" id="cb1-164" title="164">            <span class="cf">if</span> (a[i][<span class="dv">0</span>] != m)</a>
<a class="sourceLine" id="cb1-165" title="165">                modify(a[i][<span class="dv">0</span>], m);</a>
<a class="sourceLine" id="cb1-166" title="166">        }</a>
<a class="sourceLine" id="cb1-167" title="167"><span class="co">//  for (int i = 1; i &lt;= pool; ++i)</span></a>
<a class="sourceLine" id="cb1-168" title="168"><span class="co">//  {</span></a>
<a class="sourceLine" id="cb1-169" title="169"><span class="co">//      printf(&quot;%d:\n&quot;, i);</span></a>
<a class="sourceLine" id="cb1-170" title="170"><span class="co">//      for (int j : G[i]) printf(&quot;%d &quot;, j); printf(&quot;\n&quot;);</span></a>
<a class="sourceLine" id="cb1-171" title="171"><span class="co">//  }</span></a>
<a class="sourceLine" id="cb1-172" title="172">    memset(dfn, -<span class="dv">1</span>, <span class="kw">sizeof</span>(dfn));</a>
<a class="sourceLine" id="cb1-173" title="173">    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= pool; ++i)</a>
<a class="sourceLine" id="cb1-174" title="174">        <span class="cf">if</span> (dfn[i] == -<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-175" title="175">            tarjan(i);</a>
<a class="sourceLine" id="cb1-176" title="176">    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= k; ++i) </a>
<a class="sourceLine" id="cb1-177" title="177">        ++sz[res[i]];</a>
<a class="sourceLine" id="cb1-178" title="178">    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= pool; ++i)</a>
<a class="sourceLine" id="cb1-179" title="179">        <span class="cf">for</span> (<span class="dt">int</span> j : G[i])</a>
<a class="sourceLine" id="cb1-180" title="180">            <span class="cf">if</span> (res[i] != res[j]) ++du[res[i]];</a>
<a class="sourceLine" id="cb1-181" title="181">    <span class="dt">int</span> ans = <span class="fl">2e9</span>;</a>
<a class="sourceLine" id="cb1-182" title="182">    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= k; ++i)</a>
<a class="sourceLine" id="cb1-183" title="183">        <span class="cf">if</span> (!du[res[i]]) ans = <span class="bu">std::</span>min(ans, sz[res[i]] - <span class="dv">1</span>);</a>
<a class="sourceLine" id="cb1-184" title="184">    printf(<span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span>, ans);</a>
<a class="sourceLine" id="cb1-185" title="185">    <span class="cf">return</span> <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb1-186" title="186">}</a></code></pre></div>

          </div>

          
          <div class="row">
            <div class="col-md-8">
            
            </div>
            
          </div>
          

          
          <div class="row pt-3">
            <div class="col-md-6">
              
                <a href=https://zghtyarecrenj.github.io/post/cf1479e/ class="post-meta">Previous
                  <div class="pt-2 pb-5 d-flex">
                    <i class="fas fa-angle-left text-grey font-weight-bold mr-2 active-color"></i>
                    <span>Cf1479E School Clubs</span>
                  </div>
                </a>
              
            </div>
            
            <div class="col-md-6 text-right" >
              
            </div>
          </div>

          

        </div>
        

      </div>
      

      

    </div>
    


  </main>
  


    
    

<footer class="page-footer text-center font-small mt-4 wow fadeIn">


  
  <div class="pb-2 mt-5 pt-5">
    
      <a href="//github.com/zghtyarecrenj " target="_blank" rel="noopener"><i class="fab fa-github mr-3" aria-hidden="true"></i></a>    
    
    

    

    

    

    

    


    
        <a href="mailto:zghtyarecrenj@qq.com"><i class="far fa-envelope-open mr-3" aria-hidden="true"></i></a>
    

    

    

  </div>
  

  
  <div class="copyright py-4">
    
    <span>  2016 - 2021 &copy; | Theme <a href='https://github.com/orianna-zzo/AllinOne' target="_blank">AllinOne</a> by <a href='https://github.com/orianna-zzo' target="_blank">Orianna</a>  </span>
  </div>
  

</footer>


    






<script type="text/javascript" src="https://zghtyarecrenj.github.io/js/vendors/jquery/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="https://zghtyarecrenj.github.io/js/vendors/jquery/jquery.smooth-scroll.min.js"></script>



<script type="text/javascript" src="https://zghtyarecrenj.github.io/js/vendors/popper.min.js"></script>
<script type="text/javascript" src="https://zghtyarecrenj.github.io/js/vendors/holder.min.js"></script>
<script type="text/javascript" src="https://zghtyarecrenj.github.io/js/vendors-extensions/bootstrap4/bootstrap.js" ></script>

<script type="text/javascript" src="https://zghtyarecrenj.github.io/js/vendors/mdb/mdb.min.js"></script>

<script type="text/javascript" src="https://zghtyarecrenj.github.io/js/main.js"></script>



  
  <script src="https://zghtyarecrenj.github.io/js/vendors/highlight.pack.js"> </script>
  <script>hljs.initHighlightingOnLoad();</script>












<script type="text/javascript">
  
  new WOW().init();
</script>




  </body>
</html>